function t(t){let e;return()=>(void 0===e&&(e=t()),e)}const e=t=>t,n=t=>1e3*t,i=t=>t/1e3,a=t((()=>void 0!==window.ScrollTimeline));class r{constructor(t){this.stop=()=>this.runAll("stop"),this.animations=t.filter(Boolean)}get finished(){return Promise.all(this.animations.map((t=>t.finished)))}getAll(t){return this.animations[0][t]}setAll(t,e){for(let n=0;n<this.animations.length;n++)this.animations[n][t]=e}attachTimeline(t,e){const n=this.animations.map((n=>a()&&n.attachTimeline?n.attachTimeline(t):"function"==typeof e?e(n):void 0));return()=>{n.forEach(((t,e)=>{t&&t(),this.animations[e].stop()}))}}get time(){return this.getAll("time")}set time(t){this.setAll("time",t)}get speed(){return this.getAll("speed")}set speed(t){this.setAll("speed",t)}get startTime(){return this.getAll("startTime")}get duration(){let t=0;for(let e=0;e<this.animations.length;e++)t=Math.max(t,this.animations[e].duration);return t}runAll(t){this.animations.forEach((e=>e[t]()))}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class s extends r{then(t,e){return this.finished.finally(t).then((()=>{}))}}const o=t=>t.startsWith("--"),l=(t,e,n)=>{o(e)?t.style.setProperty(e,n):t.style[e]=n},c=(t,e)=>o(e)?t.style.getPropertyValue(e):t.style[e],u=t=>null!==t;const m=t((()=>{try{document.createElement("div").animate({opacity:[1]})}catch(t){return!1}return!0})),d=new Set(["borderWidth","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderRadius","radius","borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius","width","maxWidth","height","maxHeight","top","right","bottom","left","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","margin","marginTop","marginRight","marginBottom","marginLeft","backgroundPositionX","backgroundPositionY"]);const h={value:null,addProjectionMetrics:null},p={};function f(e,n){const i=t(e);return()=>p[n]??i()}const g=f((()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch(t){return!1}return!0}),"linearEasing"),y=([t,e,n,i])=>`cubic-bezier(${t}, ${e}, ${n}, ${i})`,A={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:y([0,.65,.55,1]),circOut:y([.55,0,1,.45]),backIn:y([.31,.01,.66,-.59]),backOut:y([.33,1.53,.69,.99])};function b(t,e){return t?"function"==typeof t&&g()?((t,e,n=10)=>{let i="";const a=Math.max(Math.round(e/n),2);for(let e=0;e<a;e++)i+=t(e/(a-1))+", ";return`linear(${i.substring(0,i.length-2)})`})(t,e):(t=>Array.isArray(t)&&"number"==typeof t[0])(t)?y(t):Array.isArray(t)?t.map((t=>b(t,e)||A.easeOut)):A[t]:void 0}const T=new WeakMap;class v{constructor(t){if("animation"in t)return void(this.animation=t.animation);const{element:e,name:n,keyframes:i,pseudoElement:a,allowFlatten:r=!1}=t;let{transition:s}=t;this.allowFlatten=r;const o=function(t){const e=T.get(t)||new Map;return T.set(t,e),e}(e),h=((t,e)=>`${t}:${e}`)(n,a||""),p=o.get(h);p&&p.stop();const f=function(t,e,n,i){Array.isArray(n)||(n=[n]);for(let a=0;a<n.length;a++)null===n[a]&&(n[a]=0!==a||i?n[a-1]:c(t,e)),"number"==typeof n[a]&&d.has(e)&&(n[a]=n[a]+"px");return!i&&!m()&&n.length<2&&n.unshift(c(t,e)),n}(e,n,i,a);s.type,s=function({type:t,...e}){return function(t){return"function"==typeof t&&"applyToOptions"in t}(t)?t.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}(s),this.animation=function(t,e,n,{delay:i=0,duration:a=300,repeat:r=0,repeatType:s="loop",ease:o="easeInOut",times:l}={},c){const u={[e]:n};l&&(u.offset=l);const m=b(o,a);return Array.isArray(m)&&(u.easing=m),t.animate(u,{delay:i,duration:a,easing:Array.isArray(m)?"linear":m,fill:"both",iterations:r+1,direction:"reverse"===s?"alternate":"normal",pseudoElement:c})}(e,n,f,s,a),!1===s.autoplay&&this.animation.pause(),this.removeAnimation=()=>o.delete(h),this.animation.onfinish=()=>{a?this.commitStyles():l(e,n,function(t,{repeat:e,repeatType:n="loop"},i){const a=t.filter(u),r=e&&"loop"!==n&&e%2==1?0:a.length-1;return r&&void 0!==i?i:a[r]}(f,s)),this.cancel()},o.set(h,this)}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.finish()}cancel(){try{this.animation.cancel()}catch(t){}this.removeAnimation()}stop(){const{state:t}=this;"idle"!==t&&"finished"!==t&&(this.commitStyles(),this.cancel())}commitStyles(){this.animation.commitStyles?.()}get duration(){console.log(this.animation.effect?.getComputedTiming());const t=this.animation.effect?.getComputedTiming().duration||0;return i(Number(t))}get time(){return i(Number(this.animation.currentTime)||0)}set time(t){this.animation.currentTime=n(t)}get speed(){return this.animation.playbackRate}set speed(t){this.animation.playbackRate=t}get state(){return this.animation.playState}get startTime(){return Number(this.animation.startTime)}get finished(){return this.animation.finished}flatten(){this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"})}attachTimeline(t){return this.animation.timeline=t,this.animation.onfinish=null,e}then(t,e){return this.finished.then(t).catch(e)}}const w=["read","resolveKeyframes","update","preRender","render","postRender"];function R(t,e){let n=!1,i=!0;const a={delta:0,timestamp:0,isProcessing:!1},r=()=>n=!0,s=w.reduce(((t,n)=>(t[n]=function(t,e){let n=new Set,i=new Set,a=!1,r=!1;const s=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1},l=0;function c(e){s.has(e)&&(u.schedule(e),t()),l++,e(o)}const u={schedule:(t,e=!1,r=!1)=>{const o=r&&a?n:i;return e&&s.add(t),o.has(t)||o.add(t),t},cancel:t=>{i.delete(t),s.delete(t)},process:t=>{o=t,a?r=!0:(a=!0,[n,i]=[i,n],n.forEach(c),e&&h.value&&h.value.frameloop[e].push(l),l=0,n.clear(),a=!1,r&&(r=!1,u.process(t)))}};return u}(r,e?n:void 0),t)),{}),{read:o,resolveKeyframes:l,update:c,preRender:u,render:m,postRender:d}=s,p=()=>{const r=performance.now();n=!1,a.delta=i?1e3/60:Math.max(Math.min(r-a.timestamp,40),1),a.timestamp=r,a.isProcessing=!0,o.process(a),l.process(a),c.process(a),u.process(a),m.process(a),d.process(a),a.isProcessing=!1,n&&e&&(i=!1,t(p))};return{schedule:w.reduce(((e,r)=>{const o=s[r];return e[r]=(e,r=!1,s=!1)=>(n||(n=!0,i=!0,a.isProcessing||t(p)),o.schedule(e,r,s)),e}),{}),cancel:t=>{for(let e=0;e<w.length;e++)s[w[e]].cancel(t)},state:a,steps:s}}const{schedule:P,cancel:S,state:k,steps:E}=R("undefined"!=typeof requestAnimationFrame?requestAnimationFrame:e,!0);function O(t,e,i,a){const r=function(t,e,n){if(t instanceof EventTarget)return[t];if("string"==typeof t){let i=document;e&&(i=e.current);const a=n?.[t]??i.querySelectorAll(t);return a?Array.from(a):[]}return Array.from(t)}(t,a),s=r.length,o=[];for(let t=0;t<s;t++){const a=r[t],u={...i};"function"==typeof u.delay&&(u.delay=u.delay(t,s));for(const t in e){const i=e[t],r={...(l=u,c=t,l?.[c]??l?.default??l)};r.duration&&(r.duration=n(r.duration)),r.delay&&(r.delay=n(r.delay)),o.push(new v({element:a,name:t,keyframes:i,transition:r,allowFlatten:!u.type&&!u.ease}))}}var l,c;return o}w.reduce(((t,e)=>(t[e]=t=>S(t),t)),{});const W=t=>function(e,n,i){return new s(O(e,n,i,t))},x=W();export{x as animateMini,W as createScopedWaapiAnimate};
